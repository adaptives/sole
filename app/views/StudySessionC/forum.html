#{extends 'main.html' /}
<div>Study Session - 
	<a href="@{StudySessionC.studySession(studySession.id)}">${studySession.title}</a>
</div>
<h3 class="study-session-title">${studySession.forum.title}</h3>

<div class="course-description">
	${studySession.forum.description}
</div>


#{if question}
	#{tabbedPane show:'selected-question', tabIds:tabIds, tabNames:tabNames /}
#{/if}
#{else}
   #{tabbedPane show:'questions', tabIds:tabIds, tabNames:tabNames /}
#{/else}


<div id="questions" class="section-questions">
#{list items:studySession.forum.questions, as:'forumQuestion'}
	#{question question:forumQuestion,
	           as:'t',
			   controllerAction:'StudySessionC.forumQuestion',
			   actionArgsMap:['studySessionId':studySession.id, 'questionId':forumQuestion.id] /}
#{/list}

<div id="question-form" class="section-question-form">
		#{if user}
			#{questionForm controllerAction:'StudySessionC.postQuestion', 
						   actionArgsMap:['studySessionId':studySession.id,'forumId':studySession.forum.id] /}
		#{/if}
		#{else}
			Please <a href="@{Secure.login}">login</a> to post questions.
		#{/else}
</div>

</div>


<div id="selected-question">
	#{if question}
		#{question question:question,
	           as:'tba',
			   controllerAction:'StudySessionC.forumQuestion',
			   actionArgsMap:['studySessionId':studySession.id, 'questionId':forumQuestion.id] /}
			   
		<div id="answer-form" class="section-question-form">
			#{answerForm protected:true,
				             user:user,
							 controllerAction:'StudySessionC.postAnswer',
							 actionArgsMap:[studySessionId:studySession.id, forumId:studySession.forum.id, questionId:question.id] /}		
	    </div>
	#{/if}
</div>