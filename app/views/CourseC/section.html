#{extends 'CourseC/courseMain.html' /}
#{set course:courseSection.course /}

%{
	flash.put("url", request.method == "GET" ? request.url : "/");
}%
<h3 class="course-section-title"><a href="@{CourseC.course(courseSection.course.sanitizedTitle)}">${courseSection.course.title}</a> : ${courseSection.title}</h3>
<div class="course-description">
	${courseSection.content.nl2br()}
</div>
<hr/>

<div id="questions" class="section-questions">
</div>

<div id="selected-question" class="selected-question">
</div>

<div id="comments" class="comments">
#{list items:courseSection.comments, as:'comment'}
	<div class="comment">
		<div class="comment-content">
			${comment.content}
		</div>
		<div class="comment-at-by">
			<span>Posted on: </span><span>${comment.time.format('dd MMM yy')}</span>
			<span>By: </span>
			#{if comment.website}
				<a href="${comment.website}">${comment.author}</a>
			#{/if}
			#{else}
				${comment.author}
			#{/else}
		</div>
	</div>
#{/list}
<div class="comment-form-header">Leave a comment. You can also ask questions on the course <a href="@{CourseC.forum(courseSection.course.sanitizedTitle)}">forum</a>.</div>
<div class="comment-form">
	#{form @CourseC.comment(courseSection.course.id, courseSection.id)}
		<p>
			<div><label>Name <span class="required-field">(required)</span> </label></div>
			<input type="text" name="name" value="" id="name" /> <span class="error">#{error 'name' /}</span>
		</p>
		<p>
			<div><label>Email <span class="required-field">(required, but will not be displayed)</span></label></div>
			<input type="text" name="email" value="" id="email" /> <span class="error">#{error 'email' /}</span>
		</p>
		<p>
			<div><label>Website <span class="required-field"></span></label></div>
			<input type="text" name="website" value="" id="website" /> <span class="error">#{error 'website' /}</span>
		</p>
		<p>
			<div><label>Comment <span class="required-field">(required)</span></label></div>
			<textarea name="message" rows="8" cols="40" id="message"></textarea>
		</p>
		<p>
			<input type="submit" value="Submit" id="postComment" />
			<input type="reset" value="Clear" />
		</p>
	#{/form}
</div>
</div>